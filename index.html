<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=devi        <p class="muted">üí° 3D Controls: Click 3D area first! WASD/Arrows to move, QE/Space/Shift for up/down, Right-click drag to pan, Shift+drag nodes to move them, R for auto-rotate, C to reset camera</p>
      </section>

      <section class="card">
        <h3>Create Note</h3>nitial-scale=1,viewport-fit=cover" />
  <title>SecondBrain Map</title>
  <link rel="stylesheet" href="./assets/css/styles.css" />
  <!-- Debug logging -->
  <script>
    console.log('üß† SecondBrain starting up...');
    console.log('Current URL:', window.location.href);
    // Don't log tokens or sensitive info
  </script>
  <!-- Configuration -->
  <script src="./assets/js/config.js"></script>
  <!-- Cytoscape - Local Copy -->
  <script defer src="./assets/libs/cytoscape.min.js"></script>
  <!-- Three.js for 3D visualization - CDN (consider hosting locally for production) -->
  <!-- TODO: Download and host locally for better security and offline support -->
  <!-- Integrity hash: sha384-WAvr9qfHkK8kECY5Ack5E3vqqwKD+BUaGwXDYgTx1gkL2BxcGRbZDYp5IkKFm8Fm -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js" 
          integrity="sha384-WAvr9qfHkK8kECY5Ack5E3vqqwKD+BUaGwXDYgTx1gkL2BxcGRbZDYp5IkKFm8Fm" 
          crossorigin="anonymous"></script>
  <script>
    // Create OrbitControls manually since CDN version might not work
    window.addEventListener('DOMContentLoaded', function() {
      console.log('THREE.js loaded:', typeof THREE !== 'undefined');
      
      // Simple OrbitControls-like functionality
      if (typeof THREE !== 'undefined' && !THREE.OrbitControls) {
        console.log('Creating fallback OrbitControls');
        // We'll handle this in the app.js with our fallback implementation
      }
    });
  </script>
  <script defer src="./assets/js/app.js"></script>
</head>
<body>
  <!-- Animated background particles -->
  <div class="floating-particles" id="particles"></div>
  
  <header class="sb-header">
    <div class="brand">üß† SecondBrain Neural Map</div>
    <div class="demo-info" style="color: var(--accent); font-size: 12px; opacity: 0.8;">
      Semantic search ¬∑ Knowledge mapping ¬∑ Local-first
    </div>
    <div class="env">
      <label>Backend URL</label>
      <input id="backendUrl" type="text" placeholder="http://localhost:8000" />
      <button id="saveBackendUrl">Save</button>
    </div>
  </header>

  <main class="sb-main">
    <aside class="sidebar">
      <section class="card">
        <h3>üöÄ Login</h3>
        <p class="muted">Welcome to SecondBrain Neural Map! Enter your credentials to access your knowledge graph.</p>
        <div class="row">
          <input id="username" type="text" placeholder="username" value="" />
          <input id="password" type="password" placeholder="password" value="" />
        </div>
        <div class="row">
          <button id="btnLogin">Login</button>
          <button id="btnLogout" class="ghost">Logout</button>
        </div>
        <p class="muted" id="authStatus">Not authenticated</p>
      </section>

      <section class="card">
        <h3>üîç Semantic Search</h3>
        <p class="muted">Find notes by meaning, not just keywords. Powered by vector embeddings.</p>
        <div class="row">
          <input id="searchQuery" type="text" placeholder="Search by topic, concept, or question..." />
          <button id="btnSearch">Search</button>
        </div>
        <div id="searchResults" class="results-container"></div>
      </section>

      <section class="card">
        <h3>üó∫Ô∏è Knowledge Map (Exploratory)</h3>
        <p class="muted">Visualize connections between notes. Enable 3D mode for immersive exploration.</p>
        <div class="row">
          <label class="checkbox">
            <input id="toggle3D" type="checkbox" />
            Enable 3D Neural Map
          </label>
        </div>
        <label>Min similarity: <span id="simVal">0.45</span></label>
        <input id="minSim" type="range" min="0" max="1" step="0.01" value="0.45" />
        <label>Top-K per node: <span id="kVal">3</span></label>
        <input id="topK" type="range" min="1" max="20" step="1" value="3" />
        <label>Max nodes: <span id="maxNodesVal">200</span></label>
        <input id="maxNodes" type="range" min="2" max="2000" step="1" value="200" />
        <div class="row">
          <label class="checkbox">
            <input id="includeIsolates" type="checkbox" checked />
            Include isolated notes
          </label>
        </div>
        <div class="row">
          <button id="btnRefresh">Refresh Map</button>
          <button id="btnToggleLayout">Tree Layout</button>
        </div>
        <div class="row">
          <label class="checkbox">
            <input id="autoRotate3D" type="checkbox" />
            Auto-Rotate 3D (or press R)
          </label>
        </div>
        <p class="muted">üí° 3D Controls: Click 3D area first! WASD/Arrows to move, QE/Space/Shift for up/down, Right-click drag to pan, Shift+drag nodes to move them, R for auto-rotate, C to reset camera</p>
      </section>

      <section class="card">
        <h3>Create Note</h3>
        <div class="row">
          <input id="noteTitle" type="text" placeholder="Title" />
        </div>
        <div class="row">
          <textarea id="noteContent" rows="5" placeholder="Content"></textarea>
        </div>
        <div class="row">
          <button id="btnCreateNote">Create</button>
        </div>
        <p class="muted">Notes are auto-embedded and will appear in the map after creation.</p>
      </section>
    </aside>

    <section class="canvas">
      <div id="cy"></div>
      <div id="threeContainer" style="display:none;"></div>
      <div id="tooltip" class="tooltip hidden"></div>
      <div class="controls-hint">
        üí° Hover nodes to explore ‚Ä¢ Double-click to focus ‚Ä¢ Right-click to change layout ‚Ä¢ Toggle 3D for immersive view
      </div>
    </section>
  </main>
</body>
</html>